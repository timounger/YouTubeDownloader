name: Import Labels

on:
  push:
    branches:
      - main  # Choose the desired branch

jobs:
  import_labels:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: 14  # Choose the desired Node.js version

      - name: Install dependencies
        run: npm install @octokit/rest

      - name: Import Labels
        run: |
          const core = require('@actions/core');
          const { Octokit } = require('@octokit/rest');
          const fs = require('fs');

          const token = core.getInput('github-token');
          const octokit = new Octokit({ auth: token });
          const owner = process.env.GITHUB_REPOSITORY_OWNER;
          const repo = process.env.GITHUB_REPOSITORY;

          try {
            const labels = yaml.safeLoad(fs.readFileSync('.github/issues/labels.yml', 'utf8'));

            for (const label of labels.labels) {
              octokit.issues.createLabel({
                owner,
                repo,
                name: label.name,
                color: label.color,
                description: label.description
              });
            }
          } catch (error) {
            core.setFailed(error.message);
          }

        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
